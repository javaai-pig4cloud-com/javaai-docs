---
title: 'deepseek4j FunctionCalling'
---

Function Calling æ˜¯å¤§æ¨¡å‹çš„ä¸€ä¸ªå¼ºå¤§ç‰¹æ€§ï¼Œå®ƒå…è®¸æ¨¡å‹è°ƒç”¨é¢„å®šä¹‰çš„å‡½æ•°æ¥æ‰§è¡Œç‰¹å®šä»»åŠ¡ã€‚è¿™ä½¿å¾—æ¨¡å‹èƒ½å¤Ÿä¸å¤–éƒ¨ç³»ç»Ÿå’Œ API è¿›è¡Œäº¤äº’ï¼Œä»è€Œæ‰©å±•å…¶åŠŸèƒ½èŒƒå›´ã€‚


<Warning>æ­¤åŠŸèƒ½åªæ”¯æŒ deepseek-chat æ¨¡å‹</Warning>

## åŸºç¡€ä½¿ç”¨ç¤ºä¾‹

<img src='https://minio.pigx.vip/oss/202502/1739446054.png' alt='1739446054'/>

### 1. å®šä¹‰å·¥å…·å‡½æ•°

é¦–å…ˆï¼Œéœ€è¦å®šä¹‰å·¥å…·å‡½æ•°çš„ç»“æ„ã€‚æ¨èä½¿ç”¨ JsonSchema æ–¹å¼å®šä¹‰å‚æ•°ï¼š

```java
Function WEATHER_FUNCTION = Function.builder()
        .name("get_current_weather")
        .description("Get the current weather in a given location")
        .parameters(JsonObjectSchema.builder()
                .properties(new LinkedHashMap<String, JsonSchemaElement>() {{
                    put("location", JsonStringSchema.builder()
                            .description("The city name")
                            .build());
                }})
                .required(asList("location", "unit"))
                .build())
        .build();

// å°† Function è½¬æ¢ä¸º Tool
Tool WEATHER_TOOL = Tool.from(WEATHER_FUNCTION);
```

### 2. åˆ›å»ºè¯·æ±‚

```java
String prompt = "åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"
ChatCompletionRequest request = ChatCompletionRequest.builder()
    .model(ChatCompletionModel.DEEPSEEK_CHAT) // è¯·æ³¨æ„åªæ”¯æŒChatæ¨¡å‹
    .addUserMessage("prompt")
    .tools(WEATHER_TOOL)  // æ·»åŠ å·¥å…·å‡½æ•°
    .build();

// å‘é€è¯·æ±‚å¹¶è·å–å“åº”
ChatCompletionResponse response = deepSeekClient.chatCompletion(request).execute();

// è·å–å·¥å…·è°ƒç”¨ä¿¡æ¯
AssistantMessage assistantMessage = response.choices().get(0).message();
ToolCall toolCall = assistantMessage.toolCalls().get(0);

// è§£æå‡½æ•°è°ƒç”¨å‚æ•°
FunctionCall functionCall = toolCall.function();
String arguments = functionCall.arguments(); // {"location": "åŒ—äº¬"}

```

### 3. å¤„ç†æ¨¡å‹å“åº”å¹¶è¿”å›ç»™å¤§æ¨¡å‹

```java
 // æ‰§è¡Œå‡½æ•°è·å–ç»“æœ æ ¹æ® arguments å‚æ•°çš„åœ°ç‚¹ æŸ¥è¯¢apiè¿”å›ç»“æ„
Map map = Json.fromJson(arguments, Map.class);// {"location": "åŒ—äº¬"}
String weatherResult = map.get("location") + "æ°”æ¸© 20Â°";

// åˆ›å»ºå·¥å…·æ¶ˆæ¯
ToolMessage toolMessage = ToolMessage.from(toolCall.id(), weatherResult);

// ç»§ç»­å¯¹è¯
ChatCompletionRequest followUpRequest = ChatCompletionRequest.builder()
        .model(ChatCompletionModel.DEEPSEEK_CHAT)
        .messages(
                UserMessage.from(prompt),
                assistantMessage,
                toolMessage // æ·»åŠ å·¥å…·æ¶ˆæ¯
        )
        .build();


return deepSeekClient.chatFluxCompletion(followUpRequest);
```

<Card title="PIG AIåº”ç”¨å¼€å‘å¹³å° | é€‚åˆä¸­å¤§å‹ä¼ä¸šæ„å»ºè‡ªä¸»å¯æ§çš„AIä¸­å°" icon="link" href="https://ai.pig4cloud.com">
**ä¸ºJavaå¼€å‘è€…æä¾›å…¨æ ˆå¼AIå·¥ç¨‹åŒ–è§£å†³æ–¹æ¡ˆ**ï¼Œå¼ºç±»å‹/é«˜å¯ç»´æŠ¤æ€§æ¶æ„ï¼Œå†…ç½®30+ä¸»æµå¤§æ¨¡å‹æ”¯æŒã€‚

- **ğŸ” çŸ¥è¯†å¼•æ“ä½“ç³»**ï¼šRAG çŸ¥è¯†å¼•æ“å…¨è‡ªåŠ¨åŒ–å¤šæ¨¡æ€è§£å†³æ–¹æ¡ˆ
- **ğŸ“ AI-OCR ä¸­æ¢**ï¼šå¤æ‚éæ ‡åœºæ™¯é«˜ç²¾åº¦è¯†åˆ«
- **âš™ï¸ ä¸šåŠ¡æ™ºèƒ½èåˆ**ï¼šå‡½æ•°ç¼–æ’ + Chat2SQLï¼Œæ— ç¼å¯¹æ¥ç°æœ‰ä¸šåŠ¡ç³»ç»Ÿ
- **ğŸ›¡ï¸ Nç»´é£æ§ä½“ç³»**ï¼šæ•æ„Ÿè¯/IP/Token/User è§„åˆ™æ§åˆ¶å¼•æ“
</Card>