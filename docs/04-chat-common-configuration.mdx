---
title: API è¿›é˜¶é…ç½®
---


### 1. æ—¥å¿—é…ç½® (Logging)
LangChain4j ä½¿ç”¨ SLF4J ä½œä¸ºæ—¥å¿—æ¥å£ï¼Œæ”¯æŒé›†æˆå„ç§æ—¥å¿—åç«¯ï¼Œå¦‚ Logback æˆ– Log4jã€‚

#### çº¯ Java ç¯å¢ƒ
è¦å¯ç”¨å¯¹æ¯ä¸ªè¯·æ±‚å’Œå“åº”çš„æ—¥å¿—è®°å½•ï¼Œå¯ä»¥åœ¨åˆ›å»ºæ¨¡å‹å®ä¾‹æ—¶é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¾ç½®ï¼š

```java
OpenAiChatModel.builder()
    ...
    .logRequests(true)    // å¯ç”¨è¯·æ±‚æ—¥å¿—
    .logResponses(true)   // å¯ç”¨å“åº”æ—¥å¿—
    .build();
```

ç¡®ä¿åœ¨ä¾èµ–é¡¹ä¸­åŒ…å« SLF4J çš„æ—¥å¿—åç«¯ï¼Œæ¯”å¦‚ Logback

#### Spring Boot ç¯å¢ƒ

åœ¨ Spring Boot é›†æˆä¸­ï¼Œå¯ä»¥é€šè¿‡ `application.properties` æ–‡ä»¶é…ç½®æ—¥å¿—çº§åˆ«ï¼š

> **åªæœ‰æ—¥å¿—çº§åˆ«è°ƒæ•´ä¸ºdebugçº§åˆ«ï¼ŒåŒæ—¶é…ç½®ä»¥ä¸Š langchain æ—¥å¿—è¾“å‡ºå¼€å…³æ‰æœ‰æ•ˆ**

```yaml
logging:
  level:
    root: debug
```

### 2. ç›‘æ§ (Observability)
LangChain4j æä¾›äº†ä¸€äº›è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ `ChatModel` å’Œ `StreamingChatModel`ï¼‰ï¼Œæ”¯æŒé€šè¿‡ `ChatModelListener` ç›‘å¬ä»¥ä¸‹äº‹ä»¶ï¼š

+ è¯·æ±‚åˆ°è¾¾ LLM
+ LLM è¿”å›çš„å“åº”
+ é”™è¯¯å¤„ç†

äº‹ä»¶ç›‘å¬çš„ä¾‹å­å¦‚ä¸‹ï¼š

```java
ChatModelListener listener = new ChatModelListener() {

    @Override
    public void onRequest(ChatModelRequestContext requestContext) {
        ChatModelRequest request = requestContext.request();
        Map<Object, Object> attributes = requestContext.attributes();
        // è®°å½•è¯·æ±‚
    }

    @Override
    public void onResponse(ChatModelResponseContext responseContext) {
        ChatModelResponse response = responseContext.response();
        ChatModelRequest request = responseContext.request();
        Map<Object, Object> attributes = responseContext.attributes();
        // è®°å½•å“åº”
    }

    @Override
    public void onError(ChatModelErrorContext errorContext) {
        Throwable error = errorContext.error();
        ChatModelRequest request = errorContext.request();
        ChatModelResponse partialResponse = errorContext.partialResponse();
        Map<Object, Object> attributes = errorContext.attributes();
        // è®°å½•é”™è¯¯
    }
};

ChatModel model = OpenAiChatModel.builder()
        ...
        .listeners(List.of(listener))  // æ·»åŠ ç›‘å¬å™¨
        .build();
```

### 3. é‡è¯•æœºåˆ¶ (Retry Configuration)
LangChain4j æ”¯æŒé‡è¯•é…ç½®ï¼Œå¯ç”¨äºå¤„ç†å¤±è´¥çš„è¯·æ±‚ã€‚

å¯ä»¥é€šè¿‡ `maxRetries` æ¥é…ç½®é‡è¯•é€»è¾‘ï¼ŒæŒ‡å®šé‡è¯•æ¬¡æ•°å’Œå»¶è¿Ÿç­‰å‚æ•°ï¼š

```java
ChatModel model = OpenAiChatModel.builder()
    ...
    .maxRetries(5)  // è®¾ç½®é‡è¯•ç­–ç•¥
    .build();
```

### 4. è¶…æ—¶é…ç½® (Timeout Configuration)
å¯¹äºè¶…æ—¶é…ç½®ï¼Œå¯ä»¥é€šè¿‡ `timeout` è®¾ç½®è¯·æ±‚çš„è¶…æ—¶æ—¶é—´ï¼š

```java
ChatModel model = OpenAiChatModel.builder()
    ...
    .timeout(Duration.ofSeconds(10)) // è®¾ç½®10ç§’è¶…æ—¶
    .build();
```

<Card title="PIG AIåº”ç”¨å¼€å‘å¹³å° | é€‚åˆä¸­å¤§å‹ä¼ä¸šæ„å»ºè‡ªä¸»å¯æ§çš„AIä¸­å°" icon="link" href="https://ai.pig4cloud.com">
**ä¸ºJavaå¼€å‘è€…æä¾›å…¨æ ˆå¼AIå·¥ç¨‹åŒ–è§£å†³æ–¹æ¡ˆ**ï¼Œå¼ºç±»å‹/é«˜å¯ç»´æŠ¤æ€§æ¶æ„ï¼Œå†…ç½®30+ä¸»æµå¤§æ¨¡å‹æ”¯æŒã€‚

- **ğŸ” çŸ¥è¯†å¼•æ“ä½“ç³»**ï¼šRAG çŸ¥è¯†å¼•æ“å…¨è‡ªåŠ¨åŒ–å¤šæ¨¡æ€è§£å†³æ–¹æ¡ˆ
- **ğŸ“ AI-OCR ä¸­æ¢**ï¼šå¤æ‚éæ ‡åœºæ™¯é«˜ç²¾åº¦è¯†åˆ«
- **âš™ï¸ ä¸šåŠ¡æ™ºèƒ½èåˆ**ï¼šå‡½æ•°ç¼–æ’ + Chat2SQLï¼Œæ— ç¼å¯¹æ¥ç°æœ‰ä¸šåŠ¡ç³»ç»Ÿ
- **ğŸ›¡ï¸ Nç»´é£æ§ä½“ç³»**ï¼šæ•æ„Ÿè¯/IP/Token/User è§„åˆ™æ§åˆ¶å¼•æ“
</Card>

<Card title="æ–‡æ¡£æœ‰è¯¯ï¼Ÿè¯·ååŠ©ç¼–è¾‘" icon="pencil" href="https://github.com/javaai-pig4cloud-com/javaai-docs/edit/main/docs/04Chat å¸¸ç”¨é…ç½®.mdx">
  å‘ç°æ–‡æ¡£é—®é¢˜ï¼Ÿç‚¹å‡»æ­¤å¤„ç›´æ¥åœ¨ GitHub ä¸Šç¼–è¾‘å¹¶æäº¤ PRï¼Œå¸®åŠ©æˆ‘ä»¬æ”¹è¿›æ–‡æ¡£ï¼
</Card>



<Card title="æ–‡æ¡£æœ‰è¯¯ï¼Ÿè¯·ååŠ©ç¼–è¾‘" icon="pencil" href="https://github.com/javaai-pig4cloud-com/javaai-docs/edit/main/docs/04-chat-common-configuration.mdx">
  å‘ç°æ–‡æ¡£é—®é¢˜ï¼Ÿç‚¹å‡»æ­¤å¤„ç›´æ¥åœ¨ GitHub ä¸Šç¼–è¾‘å¹¶æäº¤ PRï¼Œå¸®åŠ©æˆ‘ä»¬æ”¹è¿›æ–‡æ¡£ï¼
</Card>
