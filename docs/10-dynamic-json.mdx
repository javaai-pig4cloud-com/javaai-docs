---
title:  ä¸šåŠ¡åŠ¨æ€ JSON ç»“æ„åŒ–
---

## 1. **å®šä¹‰åŸºç¡€çš„JSON Schema**

é¦–å…ˆï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ªåŸºç¡€çš„JSON Schemaç»“æ„ã€‚`LangChain4j`æ”¯æŒåŠ¨æ€ç”Ÿæˆå’Œè°ƒæ•´è¿™äº›ç»“æ„ï¼Œä»¥é€‚åº”ä¸åŒä¸šåŠ¡éœ€æ±‚ã€‚æ¯ä¸ªSchemaå¯ä»¥åŒ…å«å¤šç§æ•°æ®ç±»å‹ï¼ˆå¦‚å­—ç¬¦ä¸²ã€æ•°ç»„ã€æ•´æ•°ç­‰ï¼‰ï¼Œå¹¶ä¸”é€šè¿‡é”®å€¼å¯¹çš„å½¢å¼è¿›è¡Œå®šä¹‰ã€‚

```java
public JsonSchema createDynamicJsonSchema(Map<String, JsonSchemaType> properties) {
    return JsonSchema.builder()
            .rootElement(JsonObjectSchema.builder()
                    .properties(properties)
                    .build())
            .build();
}
```

åœ¨è¿™é‡Œï¼Œ`properties`æ˜¯ä¸€ä¸ª`Map`ï¼Œé”®ä¸ºJSONå­—æ®µåï¼Œå€¼ä¸ºå­—æ®µçš„ç±»å‹ï¼ˆå¦‚å­—ç¬¦ä¸²ã€æ•´æ•°ç­‰ï¼‰ã€‚å¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾ç½®ä¸åŒå­—æ®µç±»å‹ï¼Œä¾‹å¦‚ï¼š

```java
Map<String, JsonSchemaType> properties = new HashMap<>();
properties.put("invoiceNumber", JsonSchemaType.JSON_STRING_SCHEMA);
properties.put("amount", JsonSchemaType.JSON_NUMBER_SCHEMA);
```


## 2. **å°†JSON Schemaé›†æˆåˆ°è¯·æ±‚ä¸­**
ç”Ÿæˆäº†ç›¸åº”çš„JSON Schemaåï¼Œå¯ä»¥å°†å…¶åµŒå…¥åˆ°`ChatRequest`ä¸­ï¼Œæ§åˆ¶è¾“å‡ºæ ¼å¼ã€‚

```java
public void processChatWithDynamicSchema( String inputText) {
    OpenAiChatModel chatModel = OpenAiChatModel.builder()
            .strictJsonSchema(true)  // å¼ºåˆ¶è¾“å‡ºç¬¦åˆschemaçš„æ ¼å¼
            .build();

    // åŠ¨æ€ç”ŸæˆJSON Schema
    JsonSchema dynamicSchema = buildSchemaForBusiness(businessType);

    ResponseFormat responseFormat = ResponseFormat.builder()
            .type(ResponseType.JSON)  // è®¾ç½®ä¸ºJSONè¾“å‡ºæ ¼å¼
            .jsonSchema(createDynamicJsonSchema)  // åº”ç”¨åŠ¨æ€ç”Ÿæˆçš„Schema
            .build();

    ChatRequest chatRequest = ChatRequest.builder()
            .messages(UserMessage.from(
                    TextContent.from(inputText)
            ))
            .responseFormat(responseFormat)
            .build();

    ChatResponse response = chatModel.chat(chatRequest);
    System.out.println(response.aiMessage().text());
}
```


## 3. **å®é™…ä½¿ç”¨ç¤ºä¾‹**
å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸šåŠ¡åœºæ™¯éœ€è¦å¤„ç†OCRæ–‡æœ¬å’Œå‘ç¥¨ä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨`processChatWithDynamicSchema`æ¥åŠ¨æ€è®¾ç½®Schemaã€‚ä¾‹å¦‚ï¼š

```java
// å¤„ç†å‘ç¥¨ä¿¡æ¯åœºæ™¯
processChatWithDynamicSchema("Please analyze the following invoice.");
```

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¸åŒä¸šåŠ¡åœºæ™¯ä¸‹çš„Schemaå¯ä»¥åŠ¨æ€ç”Ÿæˆå¹¶æ§åˆ¶è¾“å‡ºæ ¼å¼ï¼Œä¿è¯äº†APIçš„çµæ´»æ€§å’Œç»Ÿä¸€æ€§ã€‚


è¿™ä¸€æ–¹æ¡ˆèƒ½å¤Ÿçµæ´»åº”å¯¹å„ç§ä¸šåŠ¡åœºæ™¯ï¼Œå¹¶é€šè¿‡LangChain4jåŠ¨æ€ç”Ÿæˆå’Œæ§åˆ¶è¾“å‡ºçš„JSONæ ¼å¼ï¼Œæå‡äº†å¼€å‘æ•ˆç‡ã€‚

<Card title="PIG AIåº”ç”¨å¼€å‘å¹³å° | é€‚åˆä¸­å¤§å‹ä¼ä¸šæ„å»ºè‡ªä¸»å¯æ§çš„AIä¸­å°" icon="link" href="https://ai.pig4cloud.com">
**ä¸ºJavaå¼€å‘è€…æä¾›å…¨æ ˆå¼AIå·¥ç¨‹åŒ–è§£å†³æ–¹æ¡ˆ**ï¼Œå¼ºç±»å‹/é«˜å¯ç»´æŠ¤æ€§æ¶æ„ï¼Œå†…ç½®30+ä¸»æµå¤§æ¨¡å‹æ”¯æŒã€‚

- **ğŸ” çŸ¥è¯†å¼•æ“ä½“ç³»**ï¼šRAG çŸ¥è¯†å¼•æ“å…¨è‡ªåŠ¨åŒ–å¤šæ¨¡æ€è§£å†³æ–¹æ¡ˆ
- **ğŸ“ AI-OCR ä¸­æ¢**ï¼šå¤æ‚éæ ‡åœºæ™¯é«˜ç²¾åº¦è¯†åˆ«
- **âš™ï¸ ä¸šåŠ¡æ™ºèƒ½èåˆ**ï¼šå‡½æ•°ç¼–æ’ + Chat2SQLï¼Œæ— ç¼å¯¹æ¥ç°æœ‰ä¸šåŠ¡ç³»ç»Ÿ
- **ğŸ›¡ï¸ Nç»´é£æ§ä½“ç³»**ï¼šæ•æ„Ÿè¯/IP/Token/User è§„åˆ™æ§åˆ¶å¼•æ“
</Card>

<Card title="æ–‡æ¡£æœ‰è¯¯ï¼Ÿè¯·ååŠ©ç¼–è¾‘" icon="pencil" href="https://github.com/javaai-pig4cloud-com/javaai-docs/edit/main/docs/10åŠ¨æ€JSON.mdx">
  å‘ç°æ–‡æ¡£é—®é¢˜ï¼Ÿç‚¹å‡»æ­¤å¤„ç›´æ¥åœ¨ GitHub ä¸Šç¼–è¾‘å¹¶æäº¤ PRï¼Œå¸®åŠ©æˆ‘ä»¬æ”¹è¿›æ–‡æ¡£ï¼
</Card>