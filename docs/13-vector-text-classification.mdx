---
title: æ–‡æœ¬å‘é‡åŒ–åˆ†ç±»
---

> æ™ºæ…§HR: åŸºäºLangChain4jæ–‡æœ¬å‘é‡çš„é¢è¯•è€…æ€§æ ¼ç‰¹å¾åŒ¹é…

æ€§æ ¼ç‰¹å¾åŒ¹é…æ˜¯HRé¢†åŸŸçš„ä¸€é¡¹é‡è¦ä»»åŠ¡ï¼Œå®ƒé€šè¿‡åˆ†æé¢è¯•è€…çš„è¯­è¨€è¡¨è¾¾ã€è¡Œä¸ºæ¨¡å¼ç­‰ä¿¡æ¯ï¼Œå°†å…¶ä¸é¢„å®šä¹‰çš„æ€§æ ¼æ ‡ç­¾è¿›è¡ŒåŒ¹é…ã€‚è¿™æœ‰åŠ©äºHRä¸“ä¸šäººå£«æ›´å¥½åœ°è¯„ä¼°å€™é€‰äººæ˜¯å¦é€‚åˆç‰¹å®šèŒä½æˆ–å›¢é˜Ÿæ–‡åŒ–ã€‚

## LangChain4jä¸­çš„æ–‡æœ¬åˆ†ç±»æ”¯æŒ

LangChain4jæ¡†æ¶é€šè¿‡`TextClassifier`æ¥å£ï¼Œç»“åˆå‘é‡æ¨¡å‹ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†å®ç°æ€§æ ¼ç‰¹å¾åŒ¹é…çš„å¼ºå¤§å·¥å…·ã€‚

### åŸºäºå‘é‡æ¨¡å‹çš„åˆ†ç±»å™¨å®ç°

`EmbeddingModelTextClassifier`é€šè¿‡å‘é‡æ¨¡å‹å¯¹æ–‡æœ¬è¿›è¡Œå‘é‡åŒ–ï¼Œå¹¶åˆ©ç”¨ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—æ–‡æœ¬ä¸æ€§æ ¼æ ‡ç­¾ä¹‹é—´çš„åŒ¹é…åº¦ã€‚


### é…ç½® EmbeddingModel

```java
@Bean
public EmbeddingModel embeddingModel() {
    return OpenAiEmbeddingModel.builder()
            .apiKey(System.getenv("DASHSCOPE_KEY"))
            .modelName("text-embedding-v3")
            .baseUrl("https://dashscope.aliyuncs.com/compatible-mode/v1")
            .build();
}
```

### å®šä¹‰ä¸šåŠ¡æšä¸¾

```java
@Getter
@AllArgsConstructor
public enum PersonalityTrait {
    /**
     * å¤–å‘å‹ï¼šå–œæ¬¢ç¤¾äº¤ï¼Œä»ä¸ä»–äººäº’åŠ¨ä¸­è·å¾—èƒ½é‡
     */
    EXTROVERT,

    /**
     * å†…å‘å‹ï¼šå€¾å‘äºç‹¬å¤„ï¼Œéœ€è¦å®‰é™æ—¶é—´æ¥æ¢å¤èƒ½é‡
     */
    INTROVERT,

    /**
     * åˆ†æå‹ï¼šæ“…é•¿é€»è¾‘æ€è€ƒï¼Œå–œæ¬¢è§£å†³å¤æ‚é—®é¢˜
     */
    ANALYTICAL,

    /**
     * åˆ›æ„å‹ï¼šå¯Œæœ‰æƒ³è±¡åŠ›ï¼Œå¸¸æœ‰æ–°é¢–çš„æƒ³æ³•
     */
    CREATIVE,

    /**
     * é¢†å¯¼å‹ï¼šå–„äºæŒ‡å¯¼ä»–äººï¼Œä¹äºæ‰¿æ‹…è´£ä»»
     */
    LEADER,

    /**
     * å›¢é˜Ÿåˆä½œå‹ï¼šé‡è§†åä½œï¼Œå–„äºåœ¨å›¢é˜Ÿä¸­å·¥ä½œ
     */
    TEAM_PLAYER
}
```

### é…ç½®å‘é‡æ–‡æœ¬åˆ†ç±»å™¨

```java
@Bean
public EmbeddingModelTextClassifier<PersonalityTrait> textClassifier(EmbeddingModel embeddingModel) {
    return new EmbeddingModelTextClassifier<>(embeddingModel, PersonalityTraitExamples.examples);
}
```

### ç¤ºä¾‹æ•°æ®

```java
public class PersonalityTraitExamples {
    public static final Map<PersonalityTrait, List<String>> examples = Map.of(
            PersonalityTrait.EXTROVERT, List.of(
                    "æˆ‘å–œæ¬¢ç»“è¯†æ–°æœ‹å‹",
                    "å›¢ä½“æ´»åŠ¨è®©æˆ‘å……æ»¡æ´»åŠ›",
                    "æˆ‘ç»å¸¸æ˜¯èšä¼šçš„ç„¦ç‚¹",
                    "æˆ‘å–œæ¬¢åœ¨çƒ­é—¹çš„ç¤¾äº¤ç¯å¢ƒä¸­å·¥ä½œ"
            ),
            PersonalityTrait.INTROVERT, List.of(
                    "æˆ‘æ›´å–œæ¬¢ç‹¬è‡ªå·¥ä½œ",
                    "æˆ‘éœ€è¦å®‰é™çš„æ—¶é—´æ¥å……ç”µ",
                    "å¤§å‹ç¤¾äº¤èšä¼šè®©æˆ‘æ„Ÿåˆ°å‹æŠ‘",
                    "æˆ‘å–œæ¬¢æ·±å…¥çš„ä¸€å¯¹ä¸€è°ˆè¯"
            ),
            PersonalityTrait.ANALYTICAL, List.of(
                    "æˆ‘å–œæ¬¢è§£å†³å¤æ‚çš„é—®é¢˜",
                    "æ•°æ®é©±åŠ¨çš„å†³ç­–è‡³å…³é‡è¦",
                    "æˆ‘æ€»æ˜¯å¯»æ‰¾ä¿¡æ¯ä¸­çš„æ¨¡å¼å’Œè”ç³»",
                    "æˆ‘å€¾å‘äºåœ¨é‡‡å–è¡ŒåŠ¨ä¹‹å‰å½»åº•åˆ†ææƒ…å†µ"
            ),
            PersonalityTrait.CREATIVE, List.of(
                    "æˆ‘å¸¸å¸¸è·³å‡ºæ¡†æ¶æ€è€ƒ",
                    "æˆ‘æ€»æ˜¯æƒ³å‡ºæ–°çš„ç‚¹å­",
                    "æˆ‘å–œæ¬¢å¯»æ‰¾åˆ›æ–°çš„è§£å†³æ–¹æ¡ˆ",
                    "æˆ‘å—åˆ°å‘¨å›´è‰ºæœ¯å’Œç¾çš„å¯å‘"
            ),
            PersonalityTrait.LEADER, List.of(
                    "æˆ‘èƒ½è‡ªä¿¡åœ°é¢†å¯¼é¡¹ç›®",
                    "æˆ‘æ¿€åŠ±ä»–äººå®ç°ç›®æ ‡",
                    "æˆ‘å–œæ¬¢æŒ‡å¯¼å’ŒåŸ¹å…»å›¢é˜Ÿæˆå‘˜",
                    "æˆ‘ä¸æ€•åšå‡ºè‰°éš¾çš„å†³å®š"
            ),
            PersonalityTrait.TEAM_PLAYER, List.of(
                    "åˆä½œæ˜¯æˆåŠŸçš„å…³é”®",
                    "æˆ‘é‡è§†æ‰€æœ‰å›¢é˜Ÿæˆå‘˜çš„æ„è§",
                    "æˆ‘æ€»æ˜¯æ„¿æ„å¸®åŠ©æˆ‘çš„åŒäº‹",
                    "æˆ‘ç›¸ä¿¡å›¢é˜Ÿä¸­å¤šæ ·åŒ–è§†è§’çš„åŠ›é‡"
            )
    );
}
```

### æµ‹è¯•

```java
@Autowired
private EmbeddingModelTextClassifier<PersonalityTrait> textClassifier;

@Test
void analyzePersonality() {
    List<PersonalityTrait> classify = textClassifier.classify("èµ äººç«ç‘°ï¼Œæ‰‹æœ‰ä½™é¦™");
    System.out.println(classify);
}
```


## æºç è§£æ

```java
/**
 * åŸºäºåµŒå…¥æ¨¡å‹çš„æ–‡æœ¬åˆ†ç±»å™¨
 * è¿™ä¸ªåˆ†ç±»å™¨ä½¿ç”¨åµŒå…¥æ¨¡å‹æ¥å¯¹æ–‡æœ¬è¿›è¡Œåˆ†ç±»,é€šè¿‡æ¯”è¾ƒå¾…åˆ†ç±»æ–‡æœ¬çš„åµŒå…¥ä¸æ¯ä¸ªæ ‡ç­¾çš„ç¤ºä¾‹æ–‡æœ¬åµŒå…¥çš„ç›¸ä¼¼åº¦æ¥å®ç°åˆ†ç±»ã€‚
 *
 * @param <E> æ ‡ç­¾çš„æšä¸¾ç±»å‹
 */
public class EmbeddingModelTextClassifier<E extends Enum<E>> implements TextClassifier<E> {

    // ç”¨äºç”Ÿæˆæ–‡æœ¬åµŒå…¥çš„åµŒå…¥æ¨¡å‹
    private final EmbeddingModel embeddingModel;
    
    // å­˜å‚¨æ¯ä¸ªæ ‡ç­¾å¯¹åº”çš„ç¤ºä¾‹æ–‡æœ¬åµŒå…¥
    private final Map<E, List<Embedding>> exampleEmbeddingsByLabel;
    
    // åˆ†ç±»ç»“æœè¿”å›çš„æœ€å¤§æ ‡ç­¾æ•°é‡
    private final int maxResults;
    
    // åˆ†ç±»æ—¶çš„æœ€å°ç›¸ä¼¼åº¦å¾—åˆ†é˜ˆå€¼
    private final double minScore;
    
    // å¹³å‡å¾—åˆ†å’Œæœ€å¤§å¾—åˆ†çš„æƒé‡æ¯”ä¾‹
    private final double meanToMaxScoreRatio;

    /**
     * ä½¿ç”¨é»˜è®¤å‚æ•°åˆ›å»ºåˆ†ç±»å™¨
     * maxResultsé»˜è®¤ä¸º1, minScoreé»˜è®¤ä¸º0, meanToMaxScoreRatioé»˜è®¤ä¸º0.5
     *
     * @param embeddingModel  ç”¨äºåµŒå…¥ç¤ºä¾‹å’Œå¾…åˆ†ç±»æ–‡æœ¬çš„åµŒå…¥æ¨¡å‹
     * @param examplesByLabel æ¯ä¸ªæ ‡ç­¾å¯¹åº”çš„ç¤ºä¾‹æ–‡æœ¬é›†åˆ,ç¤ºä¾‹è¶Šå¤šæ•ˆæœè¶Šå¥½
     */
    public EmbeddingModelTextClassifier(EmbeddingModel embeddingModel,
                                        Map<E, ? extends Collection<String>> examplesByLabel) {
        this(embeddingModel, examplesByLabel, 1, 0, 0.5);
    }

    /**
     * åˆ›å»ºåˆ†ç±»å™¨çš„å®Œæ•´æ„é€ å‡½æ•°
     *
     * @param embeddingModel      ç”¨äºåµŒå…¥ç¤ºä¾‹å’Œå¾…åˆ†ç±»æ–‡æœ¬çš„åµŒå…¥æ¨¡å‹
     * @param examplesByLabel     æ¯ä¸ªæ ‡ç­¾å¯¹åº”çš„ç¤ºä¾‹æ–‡æœ¬é›†åˆ
     * @param maxResults          æ¯æ¬¡åˆ†ç±»è¿”å›çš„æœ€å¤§æ ‡ç­¾æ•°é‡
     * @param minScore            åˆ†ç±»çš„æœ€å°ç›¸ä¼¼åº¦å¾—åˆ†é˜ˆå€¼,èŒƒå›´[0..1]
     * @param meanToMaxScoreRatio å¹³å‡å¾—åˆ†å’Œæœ€å¤§å¾—åˆ†çš„æƒé‡æ¯”ä¾‹,èŒƒå›´[0..1]
     *                            0è¡¨ç¤ºä»…ä½¿ç”¨å¹³å‡å¾—åˆ†,1è¡¨ç¤ºä»…ä½¿ç”¨æœ€å¤§å¾—åˆ†,0.5è¡¨ç¤ºå¹³å‡å’Œæœ€å¤§å¾—åˆ†equallyåŠ æƒ
     */
    public EmbeddingModelTextClassifier(EmbeddingModel embeddingModel,
                                        Map<E, ? extends Collection<String>> examplesByLabel,
                                        int maxResults,
                                        double minScore,
                                        double meanToMaxScoreRatio) {
        // å‚æ•°æ ¡éªŒ
        this.embeddingModel = ensureNotNull(embeddingModel, "embeddingModel");
        ensureNotNull(examplesByLabel, "examplesByLabel");

        // é¢„è®¡ç®—å¹¶å­˜å‚¨æ‰€æœ‰ç¤ºä¾‹æ–‡æœ¬çš„åµŒå…¥
        this.exampleEmbeddingsByLabel = new HashMap<>();
        examplesByLabel.forEach((label, examples) ->
                exampleEmbeddingsByLabel.put(label, embeddingModel.embedAll(
                    examples.stream()
                        .map(TextSegment::from)
                        .collect(toList())).content()
                )
        );

        // è®¾ç½®å…¶ä»–å‚æ•°
        this.maxResults = ensureGreaterThanZero(maxResults, "maxResults");
        this.minScore = ensureBetween(minScore, 0.0, 1.0, "minScore");
        this.meanToMaxScoreRatio = ensureBetween(meanToMaxScoreRatio, 0.0, 1.0, "meanToMaxScoreRatio");
    }

    /**
     * å¯¹ç»™å®šæ–‡æœ¬è¿›è¡Œåˆ†ç±»
     *
     * @param text å¾…åˆ†ç±»çš„æ–‡æœ¬
     * @return åˆ†ç±»ç»“æœ,å³æœ€ç›¸ä¼¼çš„æ ‡ç­¾åˆ—è¡¨
     */
    @Override
    public List<E> classify(String text) {
        // è·å–å¾…åˆ†ç±»æ–‡æœ¬çš„åµŒå…¥
        Embedding textEmbedding = embeddingModel.embed(text).content();

        List<LabelWithScore> labelsWithScores = new ArrayList<>();
        
        // è®¡ç®—å¾…åˆ†ç±»æ–‡æœ¬ä¸æ¯ä¸ªæ ‡ç­¾çš„ç¤ºä¾‹æ–‡æœ¬çš„ç›¸ä¼¼åº¦
        exampleEmbeddingsByLabel.forEach((label, exampleEmbeddings) -> {
            double meanScore = 0;
            double maxScore = 0;
            
            // è®¡ç®—ä¸æ¯ä¸ªç¤ºä¾‹çš„ç›¸ä¼¼åº¦
            for (Embedding exampleEmbedding : exampleEmbeddings) {
                double cosineSimilarity = CosineSimilarity.between(textEmbedding, exampleEmbedding);
                double score = RelevanceScore.fromCosineSimilarity(cosineSimilarity);
                meanScore += score;
                maxScore = Math.max(score, maxScore);
            }
            meanScore /= exampleEmbeddings.size();

            // è®¡ç®—è¯¥æ ‡ç­¾çš„ç»¼åˆå¾—åˆ†
            labelsWithScores.add(new LabelWithScore(label, aggregatedScore(meanScore, maxScore)));
        });

        // æ ¹æ®å¾—åˆ†ç­›é€‰å¹¶æ’åºæ ‡ç­¾
        return labelsWithScores.stream()
                .filter(it -> it.score >= minScore)
                // æŒ‰å¾—åˆ†é™åºæ’åº
                .sorted(comparingDouble(labelWithScore -> 1 - labelWithScore.score))
                .limit(maxResults)
                .map(it -> it.label)
                .collect(toList());
    }

    /**
     * è®¡ç®—å¹³å‡å¾—åˆ†å’Œæœ€å¤§å¾—åˆ†çš„åŠ æƒç»¼åˆå¾—åˆ†
     */
    private double aggregatedScore(double meanScore, double maxScore) {
        return (meanToMaxScoreRatio * meanScore) + ((1 - meanToMaxScoreRatio) * maxScore);
    }

    /**
     * å†…éƒ¨ç±»,ç”¨äºå­˜å‚¨æ ‡ç­¾åŠå…¶å¯¹åº”çš„å¾—åˆ†
     */
    private class LabelWithScore {
        private final E label;
        private final double score;

        private LabelWithScore(E label, double score) {
            this.label = label;
            this.score = score;
        }
    }
}
```

<Card title="PIG AIåº”ç”¨å¼€å‘å¹³å° | é€‚åˆä¸­å¤§å‹ä¼ä¸šæ„å»ºè‡ªä¸»å¯æ§çš„AIä¸­å°" icon="link" href="https://ai.pig4cloud.com">
**ä¸ºJavaå¼€å‘è€…æä¾›å…¨æ ˆå¼AIå·¥ç¨‹åŒ–è§£å†³æ–¹æ¡ˆ**ï¼Œå¼ºç±»å‹/é«˜å¯ç»´æŠ¤æ€§æ¶æ„ï¼Œå†…ç½®30+ä¸»æµå¤§æ¨¡å‹æ”¯æŒã€‚

- **ğŸ” çŸ¥è¯†å¼•æ“ä½“ç³»**ï¼šRAG çŸ¥è¯†å¼•æ“å…¨è‡ªåŠ¨åŒ–å¤šæ¨¡æ€è§£å†³æ–¹æ¡ˆ
- **ğŸ“ AI-OCR ä¸­æ¢**ï¼šå¤æ‚éæ ‡åœºæ™¯é«˜ç²¾åº¦è¯†åˆ«
- **âš™ï¸ ä¸šåŠ¡æ™ºèƒ½èåˆ**ï¼šå‡½æ•°ç¼–æ’ + Chat2SQLï¼Œæ— ç¼å¯¹æ¥ç°æœ‰ä¸šåŠ¡ç³»ç»Ÿ
- **ğŸ›¡ï¸ Nç»´é£æ§ä½“ç³»**ï¼šæ•æ„Ÿè¯/IP/Token/User è§„åˆ™æ§åˆ¶å¼•æ“
</Card>

<Card title="æ–‡æ¡£æœ‰è¯¯ï¼Ÿè¯·ååŠ©ç¼–è¾‘" icon="pencil" href="https://github.com/javaai-pig4cloud-com/javaai-docs/edit/main/docs/13å‘é‡æ–‡æœ¬åˆ†ç±».mdx">
  å‘ç°æ–‡æ¡£é—®é¢˜ï¼Ÿç‚¹å‡»æ­¤å¤„ç›´æ¥åœ¨ GitHub ä¸Šç¼–è¾‘å¹¶æäº¤ PRï¼Œå¸®åŠ©æˆ‘ä»¬æ”¹è¿›æ–‡æ¡£ï¼
</Card>

<Card title="æ–‡æ¡£æœ‰è¯¯ï¼Ÿè¯·ååŠ©ç¼–è¾‘" icon="pencil" href="https://github.com/javaai-pig4cloud-com/javaai-docs/edit/main/docs/13-vector-text-classification.mdx">
  å‘ç°æ–‡æ¡£é—®é¢˜ï¼Ÿç‚¹å‡»æ­¤å¤„ç›´æ¥åœ¨ GitHub ä¸Šç¼–è¾‘å¹¶æäº¤ PRï¼Œå¸®åŠ©æˆ‘ä»¬æ”¹è¿›æ–‡æ¡£ï¼
</Card>
