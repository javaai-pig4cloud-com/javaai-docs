---
title: RAG Easy å¿«é€Ÿä¸Šæ‰‹
---

## ä»€ä¹ˆæ˜¯ RAGï¼Ÿ

æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRetrieval-Augmented Generationï¼Œç®€ç§°RAGï¼‰æ˜¯ä¸€ç§ç»“åˆå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å’Œå¤–éƒ¨çŸ¥è¯†åº“çš„æŠ€æœ¯ï¼Œæ—¨åœ¨æé«˜ç”Ÿæˆæ–‡æœ¬çš„å‡†ç¡®æ€§å’Œç›¸å…³æ€§ã€‚ä»¥ä¸‹æ˜¯å¯¹RAGçš„é€šä¿—ä»‹ç»ï¼š
RAGçš„åŸºæœ¬æ¦‚å¿µ
RAGçš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡å¼•å…¥å¤–éƒ¨çŸ¥è¯†æºæ¥å¢å¼ºLLMçš„è¾“å‡ºèƒ½åŠ›ã€‚ä¼ ç»Ÿçš„LLMé€šå¸¸åŸºäºå…¶è®­ç»ƒæ•°æ®ç”Ÿæˆå“åº”ï¼Œä½†è¿™äº›æ•°æ®å¯èƒ½è¿‡æ—¶æˆ–ä¸å¤Ÿå…¨é¢ã€‚RAGå…è®¸æ¨¡å‹åœ¨ç”Ÿæˆç­”æ¡ˆä¹‹å‰ï¼Œä»ç‰¹å®šçš„çŸ¥è¯†åº“ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ï¼Œä»è€Œæä¾›æ›´å‡†ç¡®å’Œä¸Šä¸‹æ–‡ç›¸å…³çš„å›ç­”

## RAG æµç¨‹
RAG è¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šç´¢å¼•ï¼ˆindexingï¼‰å’Œæ£€ç´¢ï¼ˆretrievalï¼‰ã€‚LangChain4j æä¾›äº†è¿™ä¸¤ä¸ªé˜¶æ®µçš„å·¥å…·ã€‚

### ç´¢å¼•é˜¶æ®µ
åœ¨ç´¢å¼•é˜¶æ®µï¼Œæ–‡æ¡£ç»è¿‡é¢„å¤„ç†ä»¥ä¾¿åœ¨æ£€ç´¢é˜¶æ®µè¿›è¡Œé«˜æ•ˆæœç´¢ã€‚å¯¹äºå‘é‡æœç´¢ï¼Œé€šå¸¸åŒ…æ‹¬æ¸…ç†æ–‡æ¡£ã€æ·»åŠ é¢å¤–æ•°æ®å’Œå…ƒæ•°æ®ã€å°†æ–‡æ¡£åˆ†å‰²ä¸ºå°æ®µï¼ˆåˆ†å—ï¼‰ï¼Œå°†è¿™äº›æ®µè½åµŒå…¥ä¸ºå‘é‡ï¼Œå¹¶å­˜å‚¨åœ¨åµŒå…¥å­˜å‚¨ï¼ˆå‘é‡æ•°æ®åº“ï¼‰ä¸­ã€‚

ç´¢å¼•é€šå¸¸æ˜¯ç¦»çº¿è¿›è¡Œçš„ï¼Œå¯ä»¥é€šè¿‡å®šæœŸä»»åŠ¡ï¼ˆå¦‚æ¯å‘¨é‡å»ºç´¢å¼•ï¼‰å®Œæˆã€‚

<img src='https://minio.pigx.top/oss/202410/1728455181.png' alt='1728455181'/>
### æ£€ç´¢é˜¶æ®µ

æ£€ç´¢é˜¶æ®µé€šå¸¸æ˜¯åœ¨çº¿è¿›è¡Œçš„ï¼Œå½“ç”¨æˆ·æäº¤é—®é¢˜æ—¶ï¼Œä»ç´¢å¼•çš„æ–‡æ¡£ä¸­å¯»æ‰¾ç›¸å…³ä¿¡æ¯ã€‚å¯¹äºå‘é‡æœç´¢æ¥è¯´ï¼Œè¿™é€šå¸¸åŒ…æ‹¬å°†ç”¨æˆ·çš„æŸ¥è¯¢åµŒå…¥ä¸ºå‘é‡ï¼Œå¹¶åœ¨åµŒå…¥å­˜å‚¨ä¸­æ‰§è¡Œç›¸ä¼¼æ€§æœç´¢ï¼Œæ‰¾åˆ°ç›¸å…³çš„æ®µè½å¹¶å°†å®ƒä»¬æ³¨å…¥æç¤ºä¸­ï¼Œå†å‘é€ç»™ LLMã€‚

<img src='https://minio.pigx.top/oss/202410/1728455302.png' alt='1728455302'/>

## Easy RAG
LangChain4j æä¾›äº†"Easy RAG"åŠŸèƒ½ï¼Œæ—¨åœ¨è®©ä½ å¿«é€Ÿä¸Šæ‰‹ RAGï¼Œæ— éœ€å­¦ä¹ åµŒå…¥ã€é€‰æ‹©å‘é‡å­˜å‚¨æˆ–å¦‚ä½•è§£æå’Œåˆ†å‰²æ–‡æ¡£ç­‰å¤æ‚æ­¥éª¤ã€‚åªéœ€æŒ‡å‘ä½ çš„æ–‡æ¡£ï¼ŒLangChain4j å°†ä¸ºä½ å¤„ç†å¤§éƒ¨åˆ†ç»†èŠ‚ã€‚

#### 1. å¯¼å…¥ä¾èµ–ï¼š

```xml
<dependency>
    <groupId>dev.langchain4j</groupId>
    <artifactId>langchain4j-easy-rag</artifactId>
</dependency>
```

#### 2. é…ç½®å­˜å‚¨å’ŒAi service 

```java
/**
    * åµŒå…¥å­˜å‚¨ (ç®€æ˜“å†…å­˜å­˜å‚¨)
    *
    * @return {@link InMemoryEmbeddingStore }<{@link TextSegment }>
    */
@Bean
public InMemoryEmbeddingStore<TextSegment> embeddingStore() {
    return new InMemoryEmbeddingStore<>();
}


@Bean
public ChatAssistant assistant(ChatLanguageModel chatLanguageModel, EmbeddingStore<TextSegment> embeddingStore) {
    return AiServices.builder(ChatAssistant.class)
            .chatLanguageModel(chatLanguageModel)
            .chatMemory(MessageWindowChatMemory.withMaxMessages(10))
            .contentRetriever(EmbeddingStoreContentRetriever.from(embeddingStore))
            .build();
}
```

#### 3. å‘é‡å­˜å‚¨æ–‡æ¡£

```java
Document document = FileSystemDocumentLoader.loadDocument("/Users/lengleng/Downloads/test.docx");
EmbeddingStoreIngestor.ingest(document,embeddingStore);
```

#### 4. æµ‹ææé—®

```java
String result = assistant.chat("åˆåŒæ€»é‡‘é¢");
```

## è¿›é˜¶é…ç½®

```java
/**
 * è¿™ä¸ªç±»è´Ÿè´£å°†æ–‡æ¡£æ‘„å…¥åµŒå…¥å­˜å‚¨ã€‚
 * å®ƒä½¿ç”¨å„ç§ç»„ä»¶æ¥è½¬æ¢ã€åˆ†å‰²å’ŒåµŒå…¥æ–‡æ¡£ï¼Œç„¶åå­˜å‚¨å®ƒä»¬ã€‚
 */
public class EmbeddingStoreIngestor {

    // å°†è¾“å…¥æ–‡æ¡£è½¬æ¢ä¸ºé€‚åˆå¤„ç†çš„æ ¼å¼
    private final DocumentTransformer documentTransformer;

    // å°†æ–‡æ¡£åˆ†å‰²æˆæ›´å°çš„æ®µè½
    private final DocumentSplitter documentSplitter;

    // è½¬æ¢å•ä¸ªæ–‡æœ¬æ®µè½ï¼ˆä¾‹å¦‚ï¼Œç”¨äºæ ‡å‡†åŒ–æˆ–æ¸…ç†ï¼‰
    private final TextSegmentTransformer textSegmentTransformer;

    // ä¸ºæ–‡æœ¬æ®µè½ç”ŸæˆåµŒå…¥å‘é‡
    private final EmbeddingModel embeddingModel;

    // å­˜å‚¨ç”Ÿæˆçš„åµŒå…¥å‘é‡åŠå…¶å¯¹åº”çš„æ–‡æœ¬æ®µè½
    private final EmbeddingStore<TextSegment> embeddingStore;
}

// ä½¿ç”¨æ„å»ºå™¨æ¨¡å¼çš„ç¤ºä¾‹
EmbeddingStoreIngestor
    .builder()
    .documentTransformer()  // è®¾ç½®æ–‡æ¡£è½¬æ¢å™¨
    .documentSplitter()     // è®¾ç½®æ–‡æ¡£åˆ†å‰²å™¨
    .embeddingModel()       // è®¾ç½®åµŒå…¥æ¨¡å‹
    .embeddingStore()       // è®¾ç½®åµŒå…¥å­˜å‚¨
    .build()                // æ„å»ºEmbeddingStoreIngestorå®ä¾‹
    .ingest(document);      // å°†æ–‡æ¡£æ‘„å…¥åµŒå…¥å­˜å‚¨
```

<Card title="PIG AIåº”ç”¨å¼€å‘å¹³å° | é€‚åˆä¸­å¤§å‹ä¼ä¸šæ„å»ºè‡ªä¸»å¯æ§çš„AIä¸­å°" icon="link" href="https://ai.pig4cloud.com">
**ä¸ºJavaå¼€å‘è€…æä¾›å…¨æ ˆå¼AIå·¥ç¨‹åŒ–è§£å†³æ–¹æ¡ˆ**ï¼Œå¼ºç±»å‹/é«˜å¯ç»´æŠ¤æ€§æ¶æ„ï¼Œå†…ç½®30+ä¸»æµå¤§æ¨¡å‹æ”¯æŒã€‚

- **ğŸ” çŸ¥è¯†å¼•æ“ä½“ç³»**ï¼šRAG çŸ¥è¯†å¼•æ“å…¨è‡ªåŠ¨åŒ–å¤šæ¨¡æ€è§£å†³æ–¹æ¡ˆ
- **ğŸ“ AI-OCR ä¸­æ¢**ï¼šå¤æ‚éæ ‡åœºæ™¯é«˜ç²¾åº¦è¯†åˆ«
- **âš™ï¸ ä¸šåŠ¡æ™ºèƒ½èåˆ**ï¼šå‡½æ•°ç¼–æ’ + Chat2SQLï¼Œæ— ç¼å¯¹æ¥ç°æœ‰ä¸šåŠ¡ç³»ç»Ÿ
- **ğŸ›¡ï¸ Nç»´é£æ§ä½“ç³»**ï¼šæ•æ„Ÿè¯/IP/Token/User è§„åˆ™æ§åˆ¶å¼•æ“
</Card>

<Card title="æ–‡æ¡£æœ‰è¯¯ï¼Ÿè¯·ååŠ©ç¼–è¾‘" icon="pencil" href="https://github.com/javaai-pig4cloud-com/javaai-docs/edit/main/docs/16EasyRag.mdx">
  å‘ç°æ–‡æ¡£é—®é¢˜ï¼Ÿç‚¹å‡»æ­¤å¤„ç›´æ¥åœ¨ GitHub ä¸Šç¼–è¾‘å¹¶æäº¤ PRï¼Œå¸®åŠ©æˆ‘ä»¬æ”¹è¿›æ–‡æ¡£ï¼
</Card>